from operator import xor
red = '\033[91m'
blue= '\033[94m'
end = '\033[0m'

file = file('hash.txt', 'r')
llave = '5VANV4SDMC3VEAFR8S2M3M9U6WRH3P7FDD9T9Q10IAG5WZJ5K5'
b_add = 'FF'

for j, hashs in enumerate(file):
	hashs = hashs.rstrip();
	save = []
	data = []

	for junta in range(len(hashs)):
		if junta%2 == 0:
			try:
				save.append(hashs[junta]+hashs[junta+1])
			except:
				pass

	for i,byte in enumerate(save):
		if i > 0:
			try:
				rest_xor = hex(xor(int(byte, 16),int(hex(ord(llave[i-1])), 16)))[2:]

				if int(rest_xor, 16) > int(save[i-1], 16):
					sum_fin = hex(int(rest_xor, 16) - int(save[i-1],16))
					data.append(chr(int(sum_fin, 16)))
				else:
					sumador = hex(int(rest_xor, 16) + int(b_add, 16))
					sum_fin = hex(int(sumador, 16) - int(save[i-1], 16))
					data.append(chr(int(sum_fin, 16)))
			except:
				pass

	print '------------------'+str(j+1)+'-----------------'
	print '\nHASH: '+blue+''.join(hashs)+end
	print 'STRN: '+red+''.join(data)+end+'\n'